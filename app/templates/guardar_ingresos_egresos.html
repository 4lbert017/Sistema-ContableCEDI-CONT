<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ingresos/Egresos</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-image: url('https://wallpaperaccess.com/full/5004735.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }
        .card {
            border: 1px solid #ccc;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
        }
        .img-fluid {
            max-height: 80px;
        }
        .form-label {
            font-weight: bold;
        }
        h4, h5 {
            font-weight: bold;
            margin-bottom: 20px;
        }
        button {
            font-size: 18px;
        }

        .form-control {
            background-color: #d4f5e9; 
            color: #212529; 
            border: 1px solid #b2e0c5; 
        }

        .form-control::placeholder {
            color: #9ab8a3; 
        }

        .form-control:read-only {
            background-color: #e9faf1; 
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row justify-content-center mt-5">
            <div class="col-md-10">
                <div class="card p-4">
                    <div class="row text-center">
                        <div class="col-md-4">
                            <img src="/static/img/logo_cedicom.png" alt="Logo CEDICOM" width="100" height="auto">
                        </div>
                        <div class="col-md-4">
                            <h4>INGRESOS/EGRESOS</h4>
                        </div>
                        <div class="col-md-4">
                            <img src="/static/img/logo_ISO.png" alt="Logo ISO" width="100" height="auto">
                        </div>
                    </div>
                    <hr>

                    <!-- Formulario de ingresos y egresos -->
                    <form method="POST" action="/guardar_ingresos_egresos">
                        <div class="row">
                            <!-- Ingresos -->
                            <div class="col-md-4">
                                <h5>INGRESOS</h5>
                                <div class="mb-3">
                                    <label for="sucursal" class="form-label">Sucursal:</label>
                                    <select class="form-select" id="sucursal" name="sucursal">
                                        <option value="" disabled selected>Seleccione una sucursal</option>
                                        <option value="1">Sucursal 1</option>
                                        <option value="2">Sucursal 2</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label for="fecha" class="form-label">Fecha:</label>
                                    <input type="date" class="form-control" id="fecha" name="fecha">
                                </div>

                                <div class="mb-3">
                                    <label for="ultrasonido" class="form-label">Ultrasonido:</label>
                                    <input type="number" class="form-control" id="ultrasonido" name="ultrasonido" placeholder="$">
                                </div>

                                <div class="mb-3">
                                    <label for="rayos_x" class="form-label">Rayos X:</label>
                                    <input type="number" class="form-control" id="rayos_x" name="rayos_x" placeholder="$">
                                </div>

                                <div class="mb-3">
                                    <label for="electro" class="form-label">Electro:</label>
                                    <input type="number" class="form-control" id="electro" name="electro" placeholder="$">
                                </div>

                                <div class="mb-3">
                                    <label for="laboratorio" class="form-label">Laboratorio:</label>
                                    <input type="number" class="form-control" id="laboratorio" name="laboratorio" placeholder="$">
                                </div>

                                <div class="mb-3">
                                    <label for="mastografia" class="form-label">Mastografía:</label>
                                    <input type="number" class="form-control" id="mastografia" name="mastografia" placeholder="$">
                                </div>
                            </div>

                            <!-- Egresos -->
                            <div class="col-md-4">
                                <h5>EGRESOS</h5>
                                <div class="mb-3">
                                    <label for="terminales" class="form-label">Terminales:</label>
                                    <input type="number" class="form-control" id="terminales" name="terminales" placeholder="$">
                                </div>

                                <div class="mb-3">
                                    <label for="depositos" class="form-label">Depósitos:</label>
                                    <input type="number" class="form-control" id="depositos" name="depositos" placeholder="$">
                                </div>

                                <div class="mb-3">
                                    <label for="gastos_adicionales" class="form-label">Gastos Adicionales:</label>
                                    <input type="number" class="form-control" id="gastos_adicionales" name="gastos_adicionales" placeholder="$">
                                </div>

                                <div class="mb-3">
                                    <label for="total_egresos" class="form-label">Total Egresos:</label>
                                    <input type="number" class="form-control" id="total_egresos" name="total_egresos" placeholder="$" readonly>
                                </div>
                            </div>

                            <!-- Totales -->
                            <div class="col-md-4">
                                <h5>Total por categoría</h5>
                                <div class="mb-3">
                                    <label for="imagen" class="form-label">Imagen:</label>
                                    <input type="number" class="form-control" id="imagen" name="imagen" placeholder="$" readonly>
                                </div>

                                <div class="mb-3">
                                    <label for="lab_total" class="form-label">Laboratorio:</label>
                                    <input type="number" class="form-control" id="lab_total" name="lab_total" placeholder="$" readonly>
                                </div>

                                <div class="mb-3">
                                    <label for="total_categoria" class="form-label">Suma de Imagen y Laboratorio:</label>
                                    <input type="number" class="form-control" id="total_categoria" name="total_categoria" placeholder="$" readonly>
                                </div>

                                <div class="mb-3">
                                    <label for="total_general" class="form-label">Total General:</label>
                                    <input type="number" class="form-control" id="total_general" name="total_general" placeholder="$" readonly>
                                </div>
                                
                                <button type="submit" class="btn btn-success w-100 mt-3">Guardar</button>
                            </div>
                        </div>
                    </form>
                    <a href="/menu" class="btn btn-secondary btn-exit mt-3">Salir</a>
                </div>
            </div>
        </div>     
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const inputs = document.querySelectorAll('input[type="number"]');

            inputs.forEach(input => {
                input.addEventListener('input', calcularTotales);
            });

            function calcularTotales() {
                let totalIngresos = 0;
                let totalEgresos = 0;
                let totalGeneral = 0;

                const ultrasonido = parseFloat(document.getElementById('ultrasonido').value) || 0;
                const rayos_x = parseFloat(document.getElementById('rayos_x').value) || 0;
                const electro = parseFloat(document.getElementById('electro').value) || 0;
                const mastografia = parseFloat(document.getElementById('mastografia').value) || 0;
                const laboratorio = parseFloat(document.getElementById('laboratorio').value) || 0;
                const terminales = parseFloat(document.getElementById('terminales').value) || 0;
                const depositos = parseFloat(document.getElementById('depositos').value) || 0;
                const gastos_adicionales = parseFloat(document.getElementById('gastos_adicionales').value) || 0;

                // Calcular total de ingresos
                const totalImagen = ultrasonido + rayos_x + electro + mastografia;
                totalIngresos = totalImagen + laboratorio;

                // Calcular total de egresos
                totalEgresos = terminales + depositos + gastos_adicionales;

                // Calcular total general
                totalGeneral = totalIngresos - totalEgresos;

                // Sumar Imagen y Laboratorio
                const totalCategoria = totalImagen + laboratorio;

                // Mostrar resultados
                document.getElementById('imagen').value = totalImagen.toFixed(2); // Suma de la categoría Imagen
                document.getElementById('lab_total').value = laboratorio.toFixed(2); // Total de laboratorio
                document.getElementById('total_egresos').value = totalEgresos.toFixed(2); // Total de egresos
                document.getElementById('total_general').value = totalGeneral.toFixed(2); // Total general
                document.getElementById('total_categoria').value = totalCategoria.toFixed(2); // Suma de Imagen + Laboratorio
            }

        });
    </script>
</body>
</html>
